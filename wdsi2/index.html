<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camping Web Shop</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
</head>
<body>
    <header style="background-image: url('camping-background.jpg');">
        <div>
            <h1>Camping Web Shop</h1>
        </div>
    </header>

    <script src="script.js"></script>

    <main>
        <section id="products">
            <div class="container">
                <h2>Our Products</h2>
                <div class="product">
                    <div class="product-details">
                        <h3>Waterproof Tent</h3>
                        <p>Price: $59.99</p>
                        <button class="buy-now-btn" onclick="openPopup()">Buy Now</button> 
                        <div class="popup" id="popup">
                            <img src="cart.jpg">
                            <h4>How many tents do you want to buy?</h4>
                            <input type="number" id="quantityInput" placeholder="Enter quantity">
                            <h4>What week should the tents be ready??</h4>
                            <input type="number" id="durationInput" placeholder="Enter duration">
                            <button type="button" id="confirmBtn" onclick="sendQuantityToPython()">OK</button>
                        </div>  
                    </div>
                    <img src="tent.png" alt="Tent" class="product-image">
                </div>
            </div>
        </section>
        
    </main>

    <section id="productsLevel0">
        <div class="container">
            <h2>For Producent Level 0</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInput0" placeholder="Enter the number">
                    <p>Provide the time needed to assemble the item</p>
                    <input type="number" id="assembleInput0" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(0, '----')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel1">
        <div class="container">
            <h2>For Producent Level 1</h2>
            <div class="product">
                <div class="product-detail">
                    <input type="number" id="tentInput1" placeholder="Enter the number"><br>
                    <button type="button" id="confirmBtn" onclick="sendGenralLevel1()">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel1Roof">
        <div class="container">
            <h2>For Producent Level 1 Roof</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputRoof" placeholder="Enter the number">
                    <p>Provide the time needed to assemble the item</p>
                    <input type="number" id="assembleInputRoof" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(1, 'roof')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel1Floor">
        <div class="container">
            <h2>For Producent Level 1 Floor</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputFloor" placeholder="Enter the number">
                    <p>Provide the time needed to assemble the item</p>
                    <input type="number" id="assembleInputFloor" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(1, 'floor')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel1Entry">
        <div class="container">
            <h2>For Producent Level 1 Entry</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputEntry" placeholder="Enter the number">
                    <p>Provide the time needed to assemble the item</p>
                    <input type="number" id="assembleInputEntry" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(1, 'entry')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel1Frame">
        <div class="container">
            <h2>For Producent Level 1 Frame</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputFrame" placeholder="Enter the number">
                    <p>Provide the time needed to assemble the item</p>
                    <input type="number" id="assembleInputFrame" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(1, 'frame')">Submit</button>

                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2Ropes">
        <div class="container">
            <h2>For Producent Level 2 Ropes</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputRopes" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputRopes" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'ropes')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2WaterproofMaterial">
        <div class="container">
            <h2>For Producent Level 2 Waterproof Material</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputWaterproofMaterial" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputWaterproofMaterial" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'waterproof_material')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2FloorMaterial">
        <div class="container">
            <h2>For Producent Level 2 Floor Material</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputFloorMaterial" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputFloorMaterial" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'floor_material')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2Herrings">
        <div class="container">
            <h2>For Producent Level 2 Herrings</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputHerrings" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputHerrings" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'herrings')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2Net">
        <div class="container">
            <h2>For Producent Level 2 Net</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputNet" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputNet" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'net')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2Tubes">
        <div class="container">
            <h2>For Producent Level 2 Tubes</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputTubes" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputTubes" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'tubes')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <section id="productsLevel2Lock">
        <div class="container">
            <h2>For Producent Level 2 Lock</h2>
            <div class="product">
                <div class="product-detail">
                    <p>Provide initial stock</p> 
                    <input type="number" id="suppliesInputLock" placeholder="Enter the number">
                    <p>Provide the time needed to order the item</p>
                    <input type="number" id="orderInputLock" placeholder="Enter the number">
                    <button type="button" id="confirmBtn" onclick="submitLevel(2, 'lock')">Submit</button>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <p>&copy; 2024 Camping Web Shop</p>
    </footer>
    
<script>
    let popup = document.getElementById("popup")
    let quantityInput = document.getElementById("quantityInput");
    let durationInput = document.getElementById("durationInput");
    let suppliesInput = document.getElementById("suppliesInput");
    let assembleInput = document.getElementById("assembleInput");
    let tentInput = document.getElementById("tentInput");

    function sendQuantityToPython() {    
        const quantity = quantityInput.value;
        const duration = durationInput.value;

        if (quantity === "" || isNaN(quantity)) {
            alert("Please enter a valid number to a quantity field");
            return;
        }
        else if(duration === "" || isNaN(duration)){
            alert("Please enter a valid number to a duration field");
            return;
        }
        
        else{
                // Send to Python using AJAX
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "http://127.0.0.1:5000/quantity", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("Access-Control-Allow-Origin", "*")

            xhr.onload = function() {

                if (xhr.status === 200) {
                    alert("Sent to Python successfully!");
                    closePopup();
                } 
                else {
                    alert("Error sending to Python");
                }
            };
            data =  `{"quantity":${quantity}, "duration":${duration}}`;
            xhr.send(data);
        }
    }

    function submitLevel(levelValue, component){
        let supplies = 0;
        let assemble = 0;
        let order = 0;
        
        console.log(levelValue);
        console.log(component);
        console.log(order)

        if(levelValue === 0){
            supplies = suppliesInput0.value;
            assemble = assembleInput0.value;
        }
        else if(levelValue === 1){
            if(component === "roof"){
                supplies = suppliesInputRoof.value;
                assemble = assembleInputRoof.value;
            }
            else if(component === "frame"){
                supplies = suppliesInputFrame.value;
                assemble = assembleInputFrame.value;
            }
            else if(component === "floor"){
                supplies = suppliesInputFloor.value;
                assemble = assembleInputFloor.value;
            }
            else if(component === "entry"){
                supplies = suppliesInputEntry.value;
                assemble = assembleInputEntry.value;
            }
        }
        else if(levelValue === 2){
            if(component === "ropes"){
                supplies = suppliesInputRopes.value;
                order = orderInputRopes.value;
            }
            else if(component === "waterproof_material"){
                supplies = suppliesInputWaterproofMaterial.value;
                order = orderInputWaterproofMaterial.value;
            }
            else if(component === "floor_material"){
                supplies = suppliesInputWaterproofMaterial.value;
                order = orderInputWaterproofMaterial.value;
            }
            else if(component === "tubes"){
                supplies = suppliesInputTubes.value;
                order = orderInputTubes.value;
            }
            else if(component === "herrings"){
                supplies = suppliesInputHerrings.value;
                order = orderInputHerrings.value;
            }
            else if(component === "net"){
                supplies = suppliesInputNet.value;
                order = orderInputNet.value;
            }
            else if(component === "lock"){
                supplies = suppliesInputLock.value;
                order = orderInputLock.value;
            }
        }

        if(supplies === "" || isNaN(supplies)){
            alert("Please enter a valid number to a supplies field");
            return;
        }
        else if(assemble === "" || isNaN(assemble)){
            alert("Please enter a valid number to an assemble field");
            return;
        }
        else if(order === "" || isNaN(order)){                                   // do 2
            alert("Please enter a valid number to an assemble field");
            return;
        }
        else{
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "http://127.0.0.1:5000/producent", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("Access-Control-Allow-Origin", "*");

            xhr.onload = function() {
                if (xhr.status === 200) {
                    alert("Sent to Python successfully!");
                    performAnalise(levelValue);
                } 
                else {
                    alert("Error sending to Python");
                }
            }

            data =  `{"component": \"${component}\", "supplies":${supplies}, "assemble":${assemble}, "order":${order}}`;
            xhr.send(data);
        }
    }

    function sendGenralLevel1(){
        const tent = tentInput1.value;
        
        if(tent === "" || isNaN(tent)){
            alert("Please enter a valid number to a tent field");
            return;
        }
        else{
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "http://127.0.0.1:5000/tent", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("Access-Control-Allow-Origin", "*");

            xhr.onload = function() {

                if (xhr.status === 200) {
                    alert("Sent to Python successfully!");
                } 
                else {
                    alert("Error sending to Python");
                }
            }
            data =  `{"tent":${tent}}`;
            xhr.send(data);
        }
    }


    function performAnalise(levelValue){
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "http://127.0.0.1:5000/exl", true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.setRequestHeader("Access-Control-Allow-Origin", "*");

        xhr.onload = function() {
            if (xhr.status === 200) {
                alert("Sent to Python successfully!");
            } 
            else {
                alert("Error sending to Python");
            }
        }

        data =  `{"level":${levelValue}}`;
        xhr.send(data);
    }
    


    function openPopup(){
        popup.classList.add("open-popup");
        quantityInput.value = "";
    }
    function closePopup(){
        popup.classList.remove("open-popup");
    }
       
</script>
</body>
</html>

